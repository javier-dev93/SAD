---
title: "PEC 3"
author: "Alba Machado López - Javier Pueyo Aina"
date: "25/5/2021"
output:
  html_document:
    toc: yes
    toc_depth: 2
    number_sections: no
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{css, echo=FALSE}
p {
  text-align: justify
}

p.caption {
  font-size: 0.9em;
  font-style: italic;
  color: grey;
  margin-right: 10%;
  margin-left: 0%;  
  text-align: justify;
}

h1 {
  font-size: 2em;
  color: SteelBlue;
  text-align: justify
}

h2 {
  font-size: 1.7em;
  color: SteelBlue;
  text-align: justify
}

h3 {
  font-size: 1.5em;
  color: SteelBlue;
  text-align: justify
}
.header-section-number::after {
  content: ".";
}
ol {
  font-size: 1em;
  color: SteelBlue;
  text-align: justify
}
```

# Sección 1

## Ejercicio 1

<span style="color: SteelBlue;">Buscad un conjunto de datos relacionados con la Bioestadística o Bioinformática. Para ello, podéis utilizar algunos recursos conocidos como es el caso de http://www.bioinformatics.org/sms2/index.html o de http://biostat.mc.vanderbilt.edu/wiki/Main/DataSets.  También podéis utilizar otros recursos propios que conozcáis o que sean de vuestro interés, y siempre teniendo en cuenta que sean datos públicos que podéis utilizar.  Tenéis que explicar la procedencia de los datos así como incluir las referencias que correspondan y justificar porqué habéis elegido estos datos.</span>

Existen numerosas opciones disponibles donde obtener conjuntos de datos, entre las que se encuentran, además de las mencionadas por el propio ejercicio, [kaggle](https://www.kaggle.com/) o [data.world](https://data.world/data-society/health-status-indicators). En nuestro caso, el conjunto de datos que hemos seleccionado proviene del [repositorio de Machine Learning UC Irvine](http://archive.ics.uci.edu/ml/index.php), que contiene una colección de conjuntos de datos públicos procedentes de distintas fuentes y que facilita, de un primer vistazo, identificar las características de los conjuntos de datos e incluso los tipos de análisis que se les podrían aplicar. 

A la hora de seleccionar un conjunto de datos, tratamos de buscar alguno que tuviera un buen número de registros y bastantes variables de todos los tipos (numéricas, categóricas, booleanas...) de modo que existieran muchas posibilidades a la hora de explorar los datos e intentar obtener conclusiones. Con respecto al tema, nos centramos en buscar conjuntos de datos relacionados con el campo de la oncología, ya que se trata de una disciplina en la que los dos tenemos cierta experiencia y nos permitirá comprender mejor los datos e interpretar los resultados de los análisis que realizaremos.

En base a estas características, encontramos el conjunto de datos que finalmente hemos seleccionado, llamado [Cervical cancer (Risk Factors) Data Set](http://archive.ics.uci.edu/ml/datasets/Cervical+cancer+%28Risk+Factors%29). Este conjunto de datos contiene información demográfica, clínica y sobre hábitos de vida de mujeres tratadas en el Hospital Universitario de Caracas (Caracas, Venezuela). Más concretamente, este conjunto de datos se define en el capítulo _Transfer Learning with Partial Observability Applied to Cervical Cancer Screening_ [**1**], en el que se utiliza para evaluar una estrategia de aprendizaje por transferencia (*transfer learning*, utilizar un modelo pre-entrenado en un problema distinto al inicial) en la predicción de riesgo de cáncer de cervix.

A modo de introducción, el cáncer de cérvix (también llamado cáncer cervical o cáncer de cuello uterino) es el cuarto tipo de cáncer más común en mujeres, con tasas de mortalidad elevadas que varían según el país (en países desarrollados son menores debido a diferencias en el acceso a servicios de salud y hábitos de vida) [**2**]. 

Al inicio de la enfermedad, el cáncer de cérvix suele ser asintomático, aunque puede presentarse con sangrado excesivo y avanzar a dolor abdominal u otros síntomas. El diagnóstico de este tipo de cáncer comienza con la examinación de la paciente para detectar masas anormales, seguido de otras pruebas como la de Papanicolaou, la colposcopia o la examinación histopatológica de la biopsia. El tratamiento de esta enfermedad puede incluir quimioterapia, radioterapia e inmunoterapia, aunque en la mayoría de casos estos son tratamientos adyuvantes a una intervención quirúrgica [**3**].

Las tasas de éxito de estos tratamientos son variables, por lo que gran parte de los esfuerzos de la investigación científica en el cáncer de cervix se están centrando en su prevención y detección temprana. Es en estos casos en los que conjuntos de datos como el que se va a trabajar en esta PEC ganan relevancia, resaltando la utilidad de la bioinformática y la bioestadística como una herramienta de aplicación traslacional que pueda ser empleada en la práctica clínica. 


## Ejercicio 2

<span style="color: SteelBlue;">Utilizando R, mostrad y explicad qué tipo de fichero habéis importado y las variables que forman parte de él (tipo, clasificación,...), así como todo aquello que creáis relevante. Incluir capturas de pantalla y las instrucciones en R que habéis utilizado para importar y  mostrar los datos.</span>

```{r}
#Busqueda de conjunto de datos
cervical_cancer <- read.csv("http://archive.ics.uci.edu/ml/machine-learning-databases/00383/risk_factors_cervical_cancer.csv",stringsAsFactors = FALSE,header=T,sep=",")

#names(data) <- c("birads","age","shape","margin","density","severity")
```

```{r}
dim(cervical_cancer)
```

```{r}
str(cervical_cancer)
```

```{r}

```

```{r}

```

## Ejercicio 3

<span style="color: SteelBlue;"> Realizad un mínimo de seis preguntas objetivo que den una idea de la información contenida en el conjunto de datos escogido, es decir, obtener infor-mación del conjunto de datos a partir de determinados criterios, según varia-bles, o rangos de valores, etc... Para ello, podéis basaros en el tipo de consultas realizadas en la PEC1 y también utilizando, en alguno de los casos, la definición de funciones tal como se trabaja en el LAB3.</span>

### Pregunta 1

En primer lugar, dado que los propios autores del dataset advierten que hubo pacientes que decidieron responder a algunas preguntas por cuestiones de privacidad, nos preguntamos ¿Cuántos valores faltantes (*missing values*) hay en el dataset? ¿Se concentran en alguna variable en concreto?

```{r}
# Reemplazamos las interrogaciones por NA

cervical_cancer[cervical_cancer == "?"] <- NA

```

Como los propios autores indican [**1**], estos valores faltantes pueden "imputarse" usando la media muestral, ya que, aunque sería preferible tener los datos reales, es mejor que eliminar a una paciente del conjunto de datos sólo por tener valores faltantes en alguna de las variables. 

```{r}

```


### Pregunta 2

Después, es interesante conocer cuántas mujeres participaron en el estudio, así como la proporción de mujeres que fueron diagnosticadas finalmente con cáncer de cervix. 

```{r}

```


### Pregunta 3

A la hora de hacer un estudio en cancer, la edad es una variable que tiene una gran relevancia, ya que las prevalencias pueden variar mucho según la edad de los pacientes. En el caso concreto del cáncer de cérvix, la mayoría de casos se diagnostican entre los 35 y los 44 años [**4**]. Por ello, sería útil conocer los valores mínimos y máximos de esta variable, o recodificarla en forma de factor definiendo rangos de edad. 

```{r}

```

### Pregunta 4

También relacionada con la edad, un factor importante en el cáncer de cervix es el estado menopáusico de la paciente. Si establecemos la edad a partir de la cual suele aparecer la menopausia (varía según la etnia, la establecemos en 49.7 años, que se corresponde con la edad media en Latino-América [**5**]) podemos definir una nueva columna "Menopause" que indique si la paciente es pre- o post-menopáusica.

```{r}

```


### Pregunta 5

Se ha reportado que el herpesvirus es una de las causas más frecuentes de cáncer de cervix en humanos [**6**]. ¿En cuántas pacientes de las diagnosticadas con cáncer de cervix se detectó infección por este virus?

```{r}

```


### Pregunta 6

Finalmente, las cuatro últimas variables del dataset (Hinselmann, Schiller, Cytology y Biopsy) indican pruebas diagnósticas utilizadas frecuentemente en cáncer. Separando por pacientes diagnosticadas con cáncer, se podría un nuevo dataset con el número total de pruebas positivas (entre 0 y 4).

```{r}

```



## Ejercicio 4

<span style="color: SteelBlue;">Realizad un análisis descriptivo de los datos. Este estudio debe incluir, un resumen paramétrico de los datos y diversas representaciones gráficas de los mismos basadas en determinados criterios. Dejamos a vuestra elección el tipo de gráficos y los criterios utilizados.</span>


```{r}

```

```{r}

```

## Ejercicio 5

<span style="color: SteelBlue;">Realizad, basándoos en los conceptos trabajados en el LAB4 y PEC2, un mínimo de tres enunciados que respondan a una cuestión de probabilidad y un mínimo de un enunciado que corresponda a un breve modelo de simulación. En este caso, si vuestro conjunto de datos no propicia estos enunciados, podéis generar una o diversas distribuciones en base a unos parámetros determinados definidos por vosotros.</span>


```{r}

```

```{r}

```

## Ejercicio 6

<span style="color: SteelBlue;">Realizad un breve análisis de regresión (lineal y múltiple) a partir de las variables que disponéis y utilizando el criterio que responda a alguna pregunta de interés que os hayáis planteado.</span>

Como ya se ha comentado, el diagnóstico de enfermedades de transmisión sexual (como el HPV) pueden ser de gran relevancia en el cáncer de cervix. Nos planteamos si, utilizando el resto de variables del conjunto (correspondientes principalmente a información sobre hábitos de vida) podemos crear un modelo que prediga el número de ETS que puede sufrir la paciente.


```{r}

```

```{r}

```

## Ejercicio 7

<span style="color: SteelBlue;">A partir del conjunto de datos que estáis trabajando, plantead un estudio ANOVA y desarrolladlo si, a partir del estudio previo, se cumplen las condiciones.</span>

Estudios previos han demostrado que existe una asociación entre la edad en la que ocurre la primera relación sexual y el riesgo de cáncer de cervix, posiblemente debido a una mayor probabilidad de infección temprana por HPV [**7**]. Procedemos a comprobar si se detecta esta asociación en el conjunto de datos de trabajo. 

```{r}
cervical_cancer$Dx.Cancer <- factor(cervical_cancer$Dx.Cancer)

cervical_cancer_anova <- aov(First.sexual.intercourse~Dx.Cancer,data=cervical_cancer, na.action=na.omit)

# Mostramos el resumen estadístico del test
summary(cervical_cancer_anova)
```

```{r}

```

## Ejercicio 8

<span style="color: SteelBlue;">A partir de los datos de origen y el estudio realizado, haced una valoración final. Para ello, podéis basaros en las siguientes preguntas: "disponemos de conclusiones finales?", "sería necesario hacer un análisis más avanzado?", "faltan datos para obtener otro tipo de información como...?",....</span>


```{r}

```

```{r}

```


# Sección 2. Análisis cluster con R


```{r}

```


```{r}

```


# Referencias

-  **[1]**: Fernandes, K., Cardoso, J.S., Fernandes, J. (2017) Transfer Learning with Partial Observability Applied to Cervical Cancer Screening. In: Alexandre L., Salvador Sánchez J., Rodrigues J. (eds) _Pattern Recognition and Image Analysis_. IbPRIA 2017. Lecture Notes in Computer Science, vol 10255. Springer, Cham. https://doi.org/10.1007/978-3-319-58838-4_27

- **[2]**: Buskwofie, A., David-West, G., & Clare, C. A. (2020). A Review of Cervical Cancer: Incidence and Disparities. _Journal of the National Medical Association_, 112(2), 229–232. https://doi.org/10.1016/j.jnma.2020.03.002 

- **[3]**: Johnson, C. A., James, D., Marzan, A., & Armaos, M. (2019). Cervical Cancer: An Overview of Pathophysiology and Management. _Seminars in oncology nursing_, 35(2), 166–174. https://doi.org/10.1016/j.soncn.2019.02.003

- **[4]**: Siegel, R. L., Miller, K. D., Fuchs, H. E., & Jemal, A. (2021). Cancer Statistics, 2021. _CA: a cancer journal for clinicians_, 71(1), 7–33. https://doi.org/10.3322/caac.21654

- [**5**]: Castelo-Branco, C., Blümel, J. E., Chedraui, P., Calle, A., Bocanera, R., Depiano, E., Figueroa-Casas, P., Gonzalez, C., Martino, M., Royer, M., Zuñiga, C., Dulon, A., Espinoza, M. T., Futchner, C., Mostajo, D., Soto, E., Albernaz, M. A., Aravena, H., Busquets, M., Campodonico, I., … Figueroa-Casas, P. (2006). Age at menopause in Latin America. _Menopause_ (New York, N.Y.), 13(4), 706–712. https://doi.org/10.1097/01.gme.0000227338.73738.2d

- [**6**]: Bedell, S. L., Goldstein, L. S., Goldstein, A. R., & Goldstein, A. T. (2020). Cervical Cancer Screening: Past, Present, and Future. _Sexual medicine reviews_, 8(1), 28–37. https://doi.org/10.1016/j.sxmr.2019.09.005

- [**7**]: Plummer, M., Peto, J., Franceschi, S., & International Collaboration of Epidemiological Studies of Cervical Cancer (2012). Time since first sexual intercourse and the risk of cervical cancer. _International journal of cancer_, 130(11), 2638–2644. https://doi.org/10.1002/ijc.26250